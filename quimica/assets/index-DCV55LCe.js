/*!
 * Copyright (c) 2025 ifmgrn
 * Licensed under the GNU AGPL-3.0 License.
 * See LICENSE.txt for details.
 */import"./kekule-BK_5NSOM.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();const U=`<header>
	<nav>
		<button id="periodictable_button">Átomos</button>
		<button id="molecules_button">Moléculas</button>
		<button id="reactions_button">Reações</button>
	</nav>
	<div aria-hidden="true" class="top-art-deco-frame"></div>
</header>
<main id="main"></main>
`;class y{container;html;class;pM;static params={};constructor(t,n){this.container=t,this.pM=n}load(t={}){return this.class&&this.container.classList.add(this.class),this.html&&(this.container.innerHTML=this.html,this.html=void 0),this.onload(this.container,t)}async unload(){await this.onunload(),this.class&&this.container.classList.remove(this.class),this.container.innerHTML=""}async onload(t,n){}async onunload(){}}class z{container;pages;currentPage;constructor(t,n){this.container=t,this.pages=n}async loadPage(t,n={}){this.currentPage&&await this.currentPage.unload(),this.currentPage=new t(this.container,this),await this.currentPage.load(n)}checkURL(){const t=new URLSearchParams(window.location.search.toLowerCase());let n;for(const r of this.pages){for(const[o,s]of Object.entries(r.params))t.has(s)&&(n||(n={}),n[o]=t.get(s));if(n)return this.loadPage(r,n)}return this.loadPage(this.pages[0])}}const W=`<h1>Tabela Períodica</h1>
<button id="filterAtoms" class="center">
	Filtrar pelos átomos selecionados
</button>
<kekule-periodic-table
	id="periodicTable"
	data-displayed-components='["symbol", "name", "atomicNumber", "atomicWeight"]'
></kekule-periodic-table>
`;class q extends y{class="periodicTable";html=W;async onload(){filterAtoms.addEventListener("click",()=>{const n=periodicTable.widget.getSelectedSymbols();n&&n.length&&(window.location.href=`${window.location.pathname}?p=${encodeURIComponent(n.join(" "))}`)})}}const Q=`<h1>Banco de Dados de Moléculas</h1>
`;class Y extends y{class="molecules";html=Q}const Z="modulepreload",G=function(e){return"/quimica/"+e},C={},J=function(t,n,r){let o=Promise.resolve();if(n&&n.length>0){let c=function(l){return Promise.all(l.map(f=>Promise.resolve(f).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),a=i?.nonce||i?.getAttribute("nonce");o=c(n.map(l=>{if(l=G(l),l in C)return;C[l]=!0;const f=l.endsWith(".css"),u=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=f?"stylesheet":Z,f||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),f)return new Promise((h,b)=>{d.addEventListener("load",h),d.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(i){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i}return o.then(i=>{for(const a of i||[])a.status==="rejected"&&s(a.reason);return t().catch(s)})},P=(e,t)=>t.some(n=>e instanceof n);let x,A;function tt(){return x||(x=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function et(){return A||(A=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const E=new WeakMap,v=new WeakMap,w=new WeakMap;function nt(e){const t=new Promise((n,r)=>{const o=()=>{e.removeEventListener("success",s),e.removeEventListener("error",i)},s=()=>{n(m(e.result)),o()},i=()=>{r(e.error),o()};e.addEventListener("success",s),e.addEventListener("error",i)});return w.set(t,e),t}function ot(e){if(E.has(e))return;const t=new Promise((n,r)=>{const o=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",i),e.removeEventListener("abort",i)},s=()=>{n(),o()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",s),e.addEventListener("error",i),e.addEventListener("abort",i)});E.set(e,t)}let T={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return E.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return m(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function N(e){T=e(T)}function rt(e){return et().includes(e)?function(...t){return e.apply(I(this),t),m(this.request)}:function(...t){return m(e.apply(I(this),t))}}function st(e){return typeof e=="function"?rt(e):(e instanceof IDBTransaction&&ot(e),P(e,tt())?new Proxy(e,T):e)}function m(e){if(e instanceof IDBRequest)return nt(e);if(v.has(e))return v.get(e);const t=st(e);return t!==e&&(v.set(e,t),w.set(t,e)),t}const I=e=>w.get(e);function it(e,t,{blocked:n,upgrade:r,blocking:o,terminated:s}={}){const i=indexedDB.open(e,t),a=m(i);return r&&i.addEventListener("upgradeneeded",c=>{r(m(i.result),c.oldVersion,c.newVersion,m(i.transaction),c)}),n&&i.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),o&&c.addEventListener("versionchange",l=>o(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}function at(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",r=>t(r.oldVersion,r)),m(n).then(()=>{})}const ct=["get","getKey","getAll","getAllKeys","count"],lt=["put","add","delete","clear"],L=new Map;function k(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(L.get(t))return L.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=lt.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(o||ct.includes(n)))return;const s=async function(i,...a){const c=this.transaction(i,o?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),o&&c.done]))[0]};return L.set(t,s),s}N(e=>({...e,get:(t,n,r)=>k(t,n)||e.get(t,n,r),has:(t,n)=>!!k(t,n)||e.has(t,n)}));const ut=["continue","continuePrimaryKey","advance"],R={},D=new WeakMap,V=new WeakMap,dt={get(e,t){if(!ut.includes(t))return e[t];let n=R[t];return n||(n=R[t]=function(...r){D.set(this,V.get(this)[t](...r))}),n}};async function*ft(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const n=new Proxy(t,dt);for(V.set(n,t),w.set(n,I(t));t;)yield n,t=await(D.get(n)||t.continue()),D.delete(n)}function j(e,t){return t===Symbol.asyncIterator&&P(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&P(e,[IDBIndex,IDBObjectStore])}N(e=>({...e,get(t,n,r){return j(t,n)?ft:e.get(t,n,r)},has(t,n){return j(t,n)||e.has(t,n)}}));let p;function B(e){return X(e).match(/[\p{L}\p{N}]+/gu)??[]}function mt(e,t){const n=["nome","tipo","reagentes","produtos"],r=new Set;for(const o of n){const s=e[o];if(Array.isArray(s))for(const i of s)B(i+" "+t[i]).forEach(a=>r.add(a));else B(s).forEach(i=>r.add(i))}return Array.from(r)}async function ht(){return(await g()).getAll("reactions")}async function pt(e){const t=B(X(e));if(!t.length)return[];const r=(await g()).transaction("reactions").store.index("terms_idx"),o=[];for(const i of t){const a=await r.getAll(IDBKeyRange.bound(i,i+"￿"));if(!a.length)return[];o.push(new Map(a.map(c=>[c.id,c])))}o.sort((i,a)=>i.size-a.size);const s=o[0];for(let i=1;i<t.length&&s.size>0;i++){const a=o[i];for(const c of s.keys())a.has(c)||s.delete(c)}return Array.from(s.values())}async function g(){return p||(sessionStorage.getItem("dev-session-active")||(await at("ChemistryDB-dev"),sessionStorage.setItem("dev-session-active","true")),p=(async()=>{let e;const t=await it("ChemistryDB-dev",1,{upgrade(n,r,o,s){n.createObjectStore("molecules"),n.createObjectStore("reactions",{keyPath:"id"}).createIndex("terms_idx","terms",{multiEntry:!0}),e=new Promise((i,a)=>{Promise.all([s.done,J(()=>import("./index-DO76UZRw.js"),[])]).then(c=>{const l=c[1].molecules,f=c[1].reactions,u=n.transaction(["reactions","molecules"],"readwrite");for(const[d,h]of Object.entries(l))u.objectStore("molecules").add(h,d);for(const d of f)u.objectStore("reactions").add({...d,id:gt(d.nome),terms:mt(d,l)});return u.done}).then(i).catch(a)})},blocking(){K()}});return e&&await e,t})())}async function K(){p&&((await p).close(),p=void 0)}function _(e){return e.length===1&&e>="0"&&e<="9"}function H(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function X(e){return H(e).toLowerCase()}function gt(e){return e.replaceAll(" ","-").toLowerCase()}function bt(e,t){return e.replace(/{{\s*(.*?)\s*}}/g,(n,r)=>(r=H(r.trim()).toLowerCase(),String(t[r])))}function yt(e,t=""){const n=e.split(`
`),r=[],o=[];function s(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function i(a){for(;o.length>0&&o[o.length-1].indent>a;){const c=o.pop();c.openLi&&(r.push("</li>"),c.openLi=!1),r.push(c.type==="ul"?"</ul>":"</ol>")}}return n.forEach(a=>{if(!a.trim()){i(-1);return}const c=a.match(/^(\t*)/),l=c?c[1].length:0,f=a.trim(),u=f.match(/^-\s+(.*)/),d=f.match(/^([0-9a-zA-Z]+)[.)]\s+(.*)/);let h;if(u)h=u[1];else if(d)h=d[2];else{i(-1),r.push(s(`<p>${f}</p>`));return}const b=u?"ul":"ol";if(i(l),o.length===0||o[o.length-1].indent<l||o[o.length-1].type!==b)r.push(`<${b} class="${t}">`),o.push({type:b,indent:l,openLi:!1});else{const S=o[o.length-1];S.openLi&&(r.push("</li>"),S.openLi=!1)}r.push(`<li>${s(h)}`),o[o.length-1].openLi=!0}),i(-1),r.join("")}function O(e,t){const n=e.selectionStart??0,r=e.selectionEnd??0,o=e.value;e.value=o.substring(0,n)+t+o.substring(r);const s=n+t.length;e.selectionStart=e.selectionEnd=s,e.focus(),e.dispatchEvent(new Event("input",{bubbles:!0}))}async function M(e,t){return t||(t=(await g()).transaction("molecules").store),(await Promise.all(e.map(async n=>`${n} (${await t.get(n)})`))).join(", ")}const wt=`<header>
	<div aria-hidden="true" class="top-art-deco-frame"></div>
	<h1>{{ nome }}</h1>
</header>
<main>
	<section>
		<ul class="center tree">
			<li>Tipo: {{ tipo }}</li>
			<li>Reagente(s): {{ reagentes }}</li>
			<li>Produto(s): {{ produtos }}</li>
			<li>Equação balanceada: {{ equação }}</li>
		</ul>
	</section>
	<section>
		<h2>Demonstração</h2>
		<iframe
			src="{{ embedded_link }}"
			loading="lazy"
			title="YouTube video player"
			frameborder="0"
			allow="encrypted-media; picture-in-picture"
			referrerpolicy="strict-origin-when-cross-origin"
			allowfullscreen
		></iframe>
	</section>
	<section>
		<h2>Instruções</h2>
		{{ instruções }}
	</section>
</main>
<footer>
	<a class="center" href=".">Ir para a página principal</a>
</footer>
`;class F extends y{class="reaction";static params={name:"r"};async onload(t,n){const r=n.name;if(!r)return window.location.assign(".");const o=await g(),s=await o.get("reactions",r);if(!s)return window.location.assign(".");document.title=s.nome;const i=o.transaction("molecules"),a={...s,reagentes:await M(s.reagentes,i.store),produtos:await M(s.produtos,i.store),instrucoes:yt(s.instrucoes,"tree")};t.insertAdjacentHTML("beforeend",bt(wt,a)),K()}}const vt=`<h1>Banco de Dados de Reações Químicas</h1>
<div class="input-container">
	<div role="group" class="hidden" aria-hidden="true">
		<button data-to-insert="₀">X₀</button>
		<button data-to-insert="₁">X₁</button>
		<button data-to-insert="₂">X₂</button>
		<button data-to-insert="₃">X₃</button>
		<button data-to-insert="₄">X₄</button>
		<button data-to-insert="₅">X₅</button>
		<button data-to-insert="₆">X₆</button>
		<button data-to-insert="₇">X₇</button>
		<button data-to-insert="₈">X₈</button>
		<button data-to-insert="₉">X₉</button>
	</div>
	<input id="input" type="search" placeholder="Filtrar..." />
</div>
<div class="overflow-auto" tabindex="0">
	<table id="table" class="full-link-rows hover-effect"></table>
</div>
`;class $ extends y{class="reactions";html=vt;typingTimer;reactionsTableColumns={"Reação Química":"nome",Tipo:"tipo","Reagente(s)":"reagentes","Produto(s)":"produtos",Equação:"equacao"};lastInputValue=void 0;addEventListeners(){input.addEventListener("keydown",t=>{if(t.key==="Escape")t.preventDefault(),input.blur();else if(t.ctrlKey&&_(t.key)){const n={0:"₀",1:"₁",2:"₂",3:"₃",4:"₄",5:"₅",6:"₆",7:"₇",8:"₈",9:"₉"};O(input,n[t.key]),t.preventDefault()}}),input.addEventListener("input",()=>{clearTimeout(this.typingTimer),g(),this.typingTimer=setTimeout(()=>this.search(),500)}),document.addEventListener("keydown",t=>{(t.key.length===1||["Backspace","Delete"].includes(t.key))&&![HTMLInputElement,HTMLTextAreaElement].some(n=>document.activeElement instanceof n)&&!t.altKey&&!t.metaKey&&(!t.shiftKey||t.key.length===1)&&(!t.ctrlKey||_(t.key))&&(input.setSelectionRange(input.value.length,input.value.length),input.focus(),t.ctrlKey&&(input.dispatchEvent(new KeyboardEvent("keydown",{ctrlKey:!0,key:t.key})),t.preventDefault()))})}setupToolbars(){const t=document.getElementsByClassName("input-container");for(const n of t){const r=n.querySelector('[role="group"]'),o=n.querySelector("input");if(!(!r||!o)){for(const s of r.querySelectorAll("button"))s.setAttribute("tabindex","0");r.addEventListener("click",s=>{const i=s.target;i instanceof HTMLButtonElement&&O(o,i.dataset.toInsert??i.textContent??"")}),o.addEventListener("focusin",()=>{r.removeAttribute("aria-hidden"),r.classList.remove("hidden")}),o.addEventListener("focusout",s=>{const i=s.relatedTarget;i instanceof Node&&r.contains(i)||(r.setAttribute("aria-hidden","true"),r.classList.add("hidden"))})}}}async generateReactionsTable(t){const n="<tr>"+Object.keys(this.reactionsTableColumns).map(a=>`<th>${a}</th>`).join("")+"</tr>",r=Object.values(this.reactionsTableColumns),o=(await g()).transaction("molecules");async function s(a){return`<tr>${(await Promise.all(r.map(async(l,f)=>{const u=a[l];return"<td>"+(f===0?`<a href="?${F.params.name}=${encodeURIComponent(a.id)}">`:"")+(Array.isArray(u)?await M(u,o.store):u)+(f===0?"</a>":"")+"</td>"}))).join("")}</tr>`}const i=await Promise.all(t.map(s));return n+i.join("")}async search(t,n=!0){t===void 0?t=input.value:input.value=t,this.lastInputValue!==t&&(this.lastInputValue=t,table.innerHTML=await this.generateReactionsTable(await(t?pt(t):ht())))}async onload(){this.addEventListeners(),this.setupToolbars();const t=new URLSearchParams(window.location.search.toLowerCase());this.search(t.get("p")??void 0)}async onunload(){clearTimeout(this.typingTimer)}}class Lt extends y{class="home";html=U;currentPage;activeButton;static params={p:"p"};async loadPage(t,n){if(this.currentPage){await this.currentPage.unload();const r=window.location.origin+window.location.pathname;window.history.replaceState({},document.title,r)}return this.activeButton&&this.activeButton.classList.remove("active"),this.activeButton=n,n.classList.add("active"),this.currentPage=new t(main),this.currentPage.load()}async onload(){for(const[t,n]of[[q,periodictable_button],[Y,molecules_button],[$,reactions_button]])n.addEventListener("click",()=>this.loadPage(t,n));return this.loadPage($,reactions_button)}}const Pt=new z(document.body,[Lt,F]);Pt.checkURL();
