/*!
 * Copyright (c) 2025 ifmgrn
 * Licensed under the GNU AGPL-3.0 License.
 * See LICENSE.txt for details.
 */import"./kekule-BK_5NSOM.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=e(o);fetch(o.href,r)}})();const F=`<header>
	<nav>
		<button id="periodictable_button">Átomos</button>
		<button id="reactions_button">Reações</button>
	</nav>
	<div aria-hidden="true" class="top-art-deco-frame"></div>
</header>
<main id="main"></main>
`;class v{container;html;class;pM;static params={};constructor(t,e){this.container=t,this.pM=e}load(t={}){return this.class&&this.container.classList.add(this.class),this.html&&(this.container.innerHTML=this.html,this.html=void 0),this.onload(this.container,t)}async unload(){await this.onunload(),this.class&&this.container.classList.remove(this.class),this.container.innerHTML=""}async onload(t,e){}async onunload(){}}class X{container;pages;currentPage;constructor(t,e){this.container=t,this.pages=e}async loadPage(t,e={}){this.currentPage&&await this.currentPage.unload(),this.currentPage=new t(this.container,this),await this.currentPage.load(e)}checkURL(){const t=new URLSearchParams(window.location.search.toLowerCase());let e;for(const s of this.pages){for(const[o,r]of Object.entries(s.params))t.has(r)&&(e||(e={}),e[o]=t.get(r));if(e)return this.loadPage(s,e)}return this.loadPage(this.pages[0])}}const W=`<h1>Tabela Períodica</h1>
<button id="filterAtoms" class="center">
	Filtrar pelos átomos selecionados
</button>
<kekule-periodic-table
	id="periodicTable"
	data-displayed-components='["symbol", "name", "atomicNumber", "atomicWeight"]'
></kekule-periodic-table>
`;class z extends v{class="periodicTable";html=W;async onload(){filterAtoms.addEventListener("click",()=>{const e=periodicTable.widget.getSelectedSymbols();e&&e.length&&(window.location.href=`${window.location.pathname}?p=${encodeURIComponent(e.join(" "))}`)})}}const Y="modulepreload",G=function(n){return"/quimica/"+n},S={},Q=function(t,e,s){let o=Promise.resolve();if(e&&e.length>0){let c=function(l){return Promise.all(l.map(h=>Promise.resolve(h).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),i=a?.nonce||a?.getAttribute("nonce");o=c(e.map(l=>{if(l=G(l),l in S)return;S[l]=!0;const h=l.endsWith(".css"),u=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=h?"stylesheet":Y,h||(d.as="script"),d.crossOrigin="",d.href=l,i&&d.setAttribute("nonce",i),document.head.appendChild(d),h)return new Promise((f,b)=>{d.addEventListener("load",f),d.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(a){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a}return o.then(a=>{for(const i of a||[])i.status==="rejected"&&r(i.reason);return t().catch(r)})},I=(n,t)=>t.some(e=>n instanceof e);let C,x;function Z(){return C||(C=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function J(){return x||(x=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const T=new WeakMap,L=new WeakMap,P=new WeakMap;function tt(n){const t=new Promise((e,s)=>{const o=()=>{n.removeEventListener("success",r),n.removeEventListener("error",a)},r=()=>{e(m(n.result)),o()},a=()=>{s(n.error),o()};n.addEventListener("success",r),n.addEventListener("error",a)});return P.set(t,n),t}function et(n){if(T.has(n))return;const t=new Promise((e,s)=>{const o=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",a),n.removeEventListener("abort",a)},r=()=>{e(),o()},a=()=>{s(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",r),n.addEventListener("error",a),n.addEventListener("abort",a)});T.set(n,t)}let A={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return T.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return m(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function V(n){A=n(A)}function nt(n){return J().includes(n)?function(...t){return n.apply(D(this),t),m(this.request)}:function(...t){return m(n.apply(D(this),t))}}function ot(n){return typeof n=="function"?nt(n):(n instanceof IDBTransaction&&et(n),I(n,Z())?new Proxy(n,A):n)}function m(n){if(n instanceof IDBRequest)return tt(n);if(L.has(n))return L.get(n);const t=ot(n);return t!==n&&(L.set(n,t),P.set(t,n)),t}const D=n=>P.get(n);function st(n,t,{blocked:e,upgrade:s,blocking:o,terminated:r}={}){const a=indexedDB.open(n,t),i=m(a);return s&&a.addEventListener("upgradeneeded",c=>{s(m(a.result),c.oldVersion,c.newVersion,m(a.transaction),c)}),e&&a.addEventListener("blocked",c=>e(c.oldVersion,c.newVersion,c)),i.then(c=>{r&&c.addEventListener("close",()=>r()),o&&c.addEventListener("versionchange",l=>o(l.oldVersion,l.newVersion,l))}).catch(()=>{}),i}function rt(n,{blocked:t}={}){const e=indexedDB.deleteDatabase(n);return t&&e.addEventListener("blocked",s=>t(s.oldVersion,s)),m(e).then(()=>{})}const at=["get","getKey","getAll","getAllKeys","count"],it=["put","add","delete","clear"],E=new Map;function R(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(E.get(t))return E.get(t);const e=t.replace(/FromIndex$/,""),s=t!==e,o=it.includes(e);if(!(e in(s?IDBIndex:IDBObjectStore).prototype)||!(o||at.includes(e)))return;const r=async function(a,...i){const c=this.transaction(a,o?"readwrite":"readonly");let l=c.store;return s&&(l=l.index(i.shift())),(await Promise.all([l[e](...i),o&&c.done]))[0]};return E.set(t,r),r}V(n=>({...n,get:(t,e,s)=>R(t,e)||n.get(t,e,s),has:(t,e)=>!!R(t,e)||n.has(t,e)}));const ct=["continue","continuePrimaryKey","advance"],$={},k=new WeakMap,H=new WeakMap,lt={get(n,t){if(!ct.includes(t))return n[t];let e=$[t];return e||(e=$[t]=function(...s){k.set(this,H.get(this)[t](...s))}),e}};async function*dt(...n){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...n)),!t)return;t=t;const e=new Proxy(t,lt);for(H.set(e,t),P.set(e,D(t));t;)yield e,t=await(k.get(e)||t.continue()),k.delete(e)}function j(n,t){return t===Symbol.asyncIterator&&I(n,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&I(n,[IDBIndex,IDBObjectStore])}V(n=>({...n,get(t,e,s){return j(t,e)?dt:n.get(t,e,s)},has(t,e){return j(t,e)||n.has(t,e)}}));let y;function B(n){return q(n).match(/[\p{L}\p{N}]+/gu)??[]}function ut(n,t){const e=["nome","tipo","reagentes","produtos"],s=new Set;for(const o of e){const r=n[o];if(Array.isArray(r))for(const a of r)B(a+" "+t[a]).forEach(i=>s.add(i));else B(r).forEach(a=>s.add(a))}return Array.from(s)}async function ht(){return(await g()).getAll("reactions")}async function pt(n){const t=B(q(n));if(!t.length)return[];const s=(await g()).transaction("reactions").store.index("terms_idx"),o=[];for(const a of t){const i=await s.getAll(IDBKeyRange.bound(a,a+"￿"));if(!i.length)return[];o.push(new Map(i.map(c=>[c.id,c])))}o.sort((a,i)=>a.size-i.size);const r=o[0];for(let a=1;a<t.length&&r.size>0;a++){const i=o[a];for(const c of r.keys())i.has(c)||r.delete(c)}return Array.from(r.values())}async function g(){return y||(sessionStorage.getItem("dev-session-active")||(await rt("ChemistryDB-dev"),sessionStorage.setItem("dev-session-active","true")),y=(async()=>{let n;const t=await st("ChemistryDB-dev",1,{upgrade(e,s,o,r){e.createObjectStore("molecules"),e.createObjectStore("reactions",{keyPath:"id"}).createIndex("terms_idx","terms",{multiEntry:!0}),n=new Promise((a,i)=>{Promise.all([r.done,Q(()=>import("./index-DO76UZRw.js"),[])]).then(c=>{const l=c[1].molecules,h=c[1].reactions,u=e.transaction(["reactions","molecules"],"readwrite");for(const[d,f]of Object.entries(l))u.objectStore("molecules").add(f,d);for(const d of h)u.objectStore("reactions").add({...d,id:mt(d.nome),terms:ut(d,l)});return u.done}).then(a).catch(i)})},blocking(){K()}});return n&&await n,t})())}async function K(){y&&((await y).close(),y=void 0)}function O(n){return n.length===1&&n>="0"&&n<="9"}function U(n){return n.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function q(n){return U(n).toLowerCase()}function mt(n){return n.replaceAll(" ","-").toLowerCase()}function ft(n,t){return n.replace(/{{\s*(.*?)\s*}}/g,(e,s)=>(s=U(s.trim()).toLowerCase(),String(t[s])))}function yt(n,t=""){const e=n.split(`
`),s=[],o=[];function r(i){return i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function a(i){for(;o.length>0&&o[o.length-1].indent>i;){const c=o.pop();c.openLi&&(s.push("</li>"),c.openLi=!1),s.push(c.type==="ul"?"</ul>":"</ol>")}}return e.forEach(i=>{if(!i.trim()){a(-1);return}const c=i.match(/^(\t*)/),l=c?c[1].length:0,h=i.trim(),u=h.match(/^-\s+(.*)/),d=h.match(/^([0-9a-zA-Z]+)[.)]\s+(.*)/);let f;if(u)f=u[1];else if(d)f=d[2];else{a(-1),s.push(r(`<p>${h}</p>`));return}const b=u?"ul":"ol";if(a(l),o.length===0||o[o.length-1].indent<l||o[o.length-1].type!==b)s.push(`<${b} class="${t}">`),o.push({type:b,indent:l,openLi:!1});else{const M=o[o.length-1];M.openLi&&(s.push("</li>"),M.openLi=!1)}s.push(`<li>${r(f)}`),o[o.length-1].openLi=!0}),a(-1),s.join("")}function N(n,t){const e=n.selectionStart??0,s=n.selectionEnd??0,o=n.value;n.value=o.substring(0,e)+t+o.substring(s);const r=e+t.length;n.selectionStart=n.selectionEnd=r,n.focus(),n.dispatchEvent(new Event("input",{bubbles:!0}))}async function w(n,t){return t||(t=(await g()).transaction("molecules").store),(await Promise.all(n.map(async e=>`${e} (${await t.get(e)})`))).join(", ")}const gt=`<h1>Banco de Dados de Reações Químicas</h1>
<div class="input-container">
	<div role="group" class="hidden" aria-hidden="true">
		<button data-to-insert="₀">X₀</button>
		<button data-to-insert="₁">X₁</button>
		<button data-to-insert="₂">X₂</button>
		<button data-to-insert="₃">X₃</button>
		<button data-to-insert="₄">X₄</button>
		<button data-to-insert="₅">X₅</button>
		<button data-to-insert="₆">X₆</button>
		<button data-to-insert="₇">X₇</button>
		<button data-to-insert="₈">X₈</button>
		<button data-to-insert="₉">X₉</button>
	</div>
	<input id="input" type="search" placeholder="Filtrar..." />
</div>
<div id="reactionsGrid"></div>
`;class _ extends v{class="reactions";html=gt;typingTimer;reactionsTableColumns={"Reação Química":"nome",Tipo:"tipo","Reagente(s)":"reagentes","Produto(s)":"produtos",Equação:"equacao"};lastInputValue=void 0;addEventListeners(){input.addEventListener("keydown",t=>{if(t.key==="Escape")t.preventDefault(),input.blur();else if(t.ctrlKey&&O(t.key)){const e={0:"₀",1:"₁",2:"₂",3:"₃",4:"₄",5:"₅",6:"₆",7:"₇",8:"₈",9:"₉"};N(input,e[t.key]),t.preventDefault()}}),input.addEventListener("input",()=>{clearTimeout(this.typingTimer),g(),this.typingTimer=setTimeout(()=>this.search(),500)}),document.addEventListener("keydown",t=>{(t.key.length===1||["Backspace","Delete"].includes(t.key))&&![HTMLInputElement,HTMLTextAreaElement].some(e=>document.activeElement instanceof e)&&!t.altKey&&!t.metaKey&&(!t.shiftKey||t.key.length===1)&&(!t.ctrlKey||O(t.key))&&(input.setSelectionRange(input.value.length,input.value.length),input.focus(),t.ctrlKey&&(input.dispatchEvent(new KeyboardEvent("keydown",{ctrlKey:!0,key:t.key})),t.preventDefault()))})}setupToolbars(){const t=document.getElementsByClassName("input-container");for(const e of t){const s=e.querySelector('[role="group"]'),o=e.querySelector("input");if(!(!s||!o)){for(const r of s.querySelectorAll("button"))r.setAttribute("tabindex","0");s.addEventListener("click",r=>{const a=r.target;a instanceof HTMLButtonElement&&N(o,a.dataset.toInsert??a.textContent??"")}),o.addEventListener("focusin",()=>{s.removeAttribute("aria-hidden"),s.classList.remove("hidden")}),o.addEventListener("focusout",r=>{const a=r.relatedTarget;a instanceof Node&&s.contains(a)||(s.setAttribute("aria-hidden","true"),s.classList.add("hidden"))})}}}async generateReactionsGrid(t){const e=(await g()).transaction("molecules");async function s(r){return`<div>
			    <lite-youtube videoid="${r.embedded_link.slice(r.embedded_link.lastIndexOf("/")+1)}" title="${r.nome}"></lite-youtube>
				<div class="info">
					<span class="field">Reação:</span><span class="value">${r.nome}</span>
					<span class="field">Tipo:</span><span class="value">${r.tipo}</span>
					<span class="field">Reagente(s):</span><span class="value">${await w(r.reagentes,e.store)}</span>
					<span class="field">Produto(s):</span><span class="value">${await w(r.produtos,e.store)}</span>
					<span class="field">Equação:</span><span class="value">${r.equacao}</span>
				</div>
			</div>`}return(await Promise.all(t.map(s))).join("")}async search(t,e=!0){t===void 0?t=input.value:input.value=t,this.lastInputValue!==t&&(this.lastInputValue=t,reactionsGrid.innerHTML=await this.generateReactionsGrid(await(t?pt(t):ht())))}async onload(){this.addEventListeners(),this.setupToolbars();const t=new URLSearchParams(window.location.search.toLowerCase());this.search(t.get("p")??void 0)}async onunload(){clearTimeout(this.typingTimer)}}class bt extends v{class="home";html=F;currentPage;activeButton;static params={p:"p"};async loadPage(t,e){if(this.currentPage){await this.currentPage.unload();const s=window.location.origin+window.location.pathname;window.history.replaceState({},document.title,s)}return this.activeButton&&this.activeButton.classList.remove("active"),this.activeButton=e,e.classList.add("active"),this.currentPage=new t(main),this.currentPage.load()}async onload(){for(const[t,e]of[[z,periodictable_button],[_,reactions_button]])e.addEventListener("click",()=>this.loadPage(t,e));return this.loadPage(_,reactions_button)}}const wt=`<header>
	<div aria-hidden="true" class="top-art-deco-frame"></div>
	<h1>{{ nome }}</h1>
</header>
<main>
	<section>
		<ul class="center tree">
			<li>Tipo: {{ tipo }}</li>
			<li>Reagente(s): {{ reagentes }}</li>
			<li>Produto(s): {{ produtos }}</li>
			<li>Equação balanceada: {{ equação }}</li>
		</ul>
	</section>
	<section>
		<h2>Demonstração</h2>
		<iframe
			src="{{ embedded_link }}"
			loading="lazy"
			title="YouTube video player"
			frameborder="0"
			allow="encrypted-media; picture-in-picture"
			referrerpolicy="strict-origin-when-cross-origin"
			allowfullscreen
		></iframe>
	</section>
	<section>
		<h2>Instruções</h2>
		{{ instruções }}
	</section>
</main>
<footer>
	<a class="center" href=".">Ir para a página principal</a>
</footer>
`;class vt extends v{class="reaction";static params={name:"r"};async onload(t,e){const s=e.name;if(!s)return window.location.assign(".");const o=await g(),r=await o.get("reactions",s);if(!r)return window.location.assign(".");document.title=r.nome;const a=o.transaction("molecules"),i={...r,reagentes:await w(r.reagentes,a.store),produtos:await w(r.produtos,a.store),instrucoes:yt(r.instrucoes,"tree")};t.insertAdjacentHTML("beforeend",ft(wt,i)),K()}}const Pt=new X(document.body,[bt,vt]);Pt.checkURL();class p extends HTMLElement{connectedCallback(){this.videoId=this.getAttribute("videoid");let t=this.querySelector(".lyt-playbtn,.lty-playbtn");if(this.playLabel=t&&t.textContent.trim()||this.getAttribute("playlabel")||"Play",this.dataset.title=this.getAttribute("title")||"",this.style.backgroundImage||(this.style.backgroundImage=`url("https://i.ytimg.com/vi/${this.videoId}/hqdefault.jpg")`,this.upgradePosterImage()),t||(t=document.createElement("button"),t.type="button",t.classList.add("lyt-playbtn","lty-playbtn"),this.append(t)),!t.textContent){const e=document.createElement("span");e.className="lyt-visually-hidden",e.textContent=this.playLabel,t.append(e)}this.addNoscriptIframe(),t.nodeName==="A"&&(t.removeAttribute("href"),t.setAttribute("tabindex","0"),t.setAttribute("role","button"),t.addEventListener("keydown",e=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),this.activate())})),this.addEventListener("pointerover",p.warmConnections,{once:!0}),this.addEventListener("focusin",p.warmConnections,{once:!0}),this.addEventListener("click",this.activate),this.needsYTApi=this.hasAttribute("js-api")||navigator.vendor.includes("Apple")||navigator.userAgent.includes("Mobi")}static addPrefetch(t,e,s){const o=document.createElement("link");o.rel=t,o.href=e,s&&(o.as=s),document.head.append(o)}static warmConnections(){p.preconnected||(p.addPrefetch("preconnect","https://www.youtube-nocookie.com"),p.addPrefetch("preconnect","https://www.google.com"),p.addPrefetch("preconnect","https://googleads.g.doubleclick.net"),p.addPrefetch("preconnect","https://static.doubleclick.net"),p.preconnected=!0)}fetchYTPlayerApi(){window.YT||window.YT&&window.YT.Player||(this.ytApiPromise=new Promise((t,e)=>{var s=document.createElement("script");s.src="https://www.youtube.com/iframe_api",s.async=!0,s.onload=o=>{YT.ready(t)},s.onerror=e,this.append(s)}))}async getYTPlayer(){return this.playerPromise||await this.activate(),this.playerPromise}async addYTPlayerIframe(){this.fetchYTPlayerApi(),await this.ytApiPromise;const t=document.createElement("div");this.append(t);const e=Object.fromEntries(this.getParams().entries());this.playerPromise=new Promise(s=>{let o=new YT.Player(t,{width:"100%",videoId:this.videoId,playerVars:e,events:{onReady:r=>{r.target.playVideo(),s(o)}}})})}addNoscriptIframe(){const t=this.createBasicIframe(),e=document.createElement("noscript");e.innerHTML=t.outerHTML,this.append(e)}getParams(){const t=new URLSearchParams(this.getAttribute("params")||[]);return t.append("autoplay","1"),t.append("playsinline","1"),t}async activate(){if(this.classList.contains("lyt-activated"))return;if(this.classList.add("lyt-activated"),this.needsYTApi)return this.addYTPlayerIframe(this.getParams());const t=this.createBasicIframe();this.append(t),t.focus()}createBasicIframe(){const t=document.createElement("iframe");return t.width=560,t.height=315,t.title=this.playLabel,t.allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",t.allowFullscreen=!0,t.referrerPolicy="strict-origin-when-cross-origin",t.src=`https://www.youtube-nocookie.com/embed/${encodeURIComponent(this.videoId)}?${this.getParams().toString()}`,t}upgradePosterImage(){setTimeout(()=>{const t=`https://i.ytimg.com/vi_webp/${this.videoId}/sddefault.webp`,e=new Image;e.fetchPriority="low",e.referrerpolicy="origin",e.src=t,e.onload=s=>{s.target.naturalHeight==90&&s.target.naturalWidth==120||(this.style.backgroundImage=`url("${t}")`)}},100)}}customElements.define("lite-youtube",p);
